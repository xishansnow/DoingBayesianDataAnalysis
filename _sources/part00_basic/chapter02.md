
# 第二章  可信度、模型和参数

<style>p{text-indent:2em}</style>

<style>img{align: center}</style>


本章的目的是介绍贝叶斯数据分析的概念框架。贝叶斯数据分析有两个基本思想。第一个思想是：贝叶斯推理是在各种可能性之间重新分配可信度；第二个基本思想是：被分配可信度的各种可能性是由某个有意义数学模型中的参数值决定的。这两个基本观点构成了本书每一项分析的概念基础。本章提供了这些想法的简单示例。本书的其余部分只是填写了这两个想法具体应用的数学和计算细节。本章还解释了每个贝叶斯分析共有的基本程序步骤。

## 2.1 贝叶斯推理是在所有可能性之间重新分配可信度

假设有一天早上我们走到外面，发现人行道湿了，想知道为什么。我们考虑所有可能导致潮湿的原因，包括最近下雨、最近花园灌溉、新喷发的地下泉水、污水管道破裂、路人洒了饮料等。如果到目前为止我们只知道人行道的某一部分是湿的，那么所有这些可能性都将基于以往的知识而具有一定的先验可信度。例如：最近的降雨可能比路人洒出的饮料更有可能发生。继续我们的外出活动，环顾四周，收集新的观察结果。如果我们观察到人行道就像树木和停放的汽车一样，在我们所能看到的范围内都是湿的，那么我们就会重新分配可信度来解释最近下雨的假设原因。其他可能的原因，如路人洒了饮料，不能解释新的观察结果。另一方面，如果相反，我们观察到湿度局限在一个很小的区域，几英尺外有一个空的饮料杯，那么我们就会重新分配可信度给溢出饮料假说，尽管它的先验概率相对较低。这种跨可能性的可信度重新分配是贝叶斯推理的本质。

贝叶斯推理的另一个例子深刻体现在神探夏洛克·福尔摩斯的话中。福尔摩斯经常对他的助手华生医生说：”我对你说过多少次，当你排除了不可能的事情后，剩下的任何事情无论多么不可能，都一定是事实”。虽然该推理没有被福尔摩斯和华生描述为贝叶斯推理，但它就是贝叶斯推理。福尔摩斯设想了一系列可能的犯罪原因并系统地收集证据，排除了一些可能的原因。如果除一个原因外的所有可能原因都被排除了，那么(贝叶斯)推理迫使他得出结论，剩余的可能原因是完全可信的，即使它在一开始看起来不太可能。

图2.1说明了福尔摩斯的推理。为说明起见，我们假设只有四种可能的原因需要解释。我们给原因A、B、C和D贴上标签。图表中条形的高度表明了候选原因的可信度(此处“可信度”是“概率”的同义词，但在本书后面以数学形式介绍时，将使用术语“概率”)。可信度从 0 到 1 不等，当候选原因可信度为0，表示该原因不可能为结果负责。如果候选原因的可信度为1，则表示该原因必须为结果负责。由于我们假设候选原因之间是相互排斥的，并且穷尽了所有可能的原因，所以所有原因的总可信度和为 1 。

图2.1的左上角图显示，四个候选原因的最初可信度相等，均为0.25。与湿润的人行道情况不同（在该情况下，先验知识表明降雨可能比新喷发地下泉水更有可能是一个原因），本图假设对候选原因的先验可信度是相同的。假设我们做了新的观察，排除了候选原因A。例如：对于犯罪嫌疑人 A ，我们知道他当时离犯罪现场很远。因此，我们必须将可信度重新分配给剩余的候选原因 B 到 D ，如图2.1的左下角图所示。重新分配的可信度分布被称为后验分布，因为这是我们在考虑到新的观察结果后所相信的。后验分布使原因 A 的可信度为零，并将0.33(即1/3)的可信度分配给候选原因 B、C 和 D 。

然后，后验分布成为后续观测的先验信念。因此，图2.1中上部的先验分布是从左下角开始的后验分布。现在假设额外的新证据排除了候选原因 B。我们现在必须将可信度重新分配给剩余的候选原因 C 和 D ，如图2.1的中下部图所示。该后验分布成为后续数据收集的先验分布，如图2.1的右上角图所示。最后，如果新数据排除了候选原因 C ，那么所有的可信度都必须落在剩余的原因 D 上，如图2.1的右下角图所示。这种可信度的重新分配不仅是直观的，而且也是贝叶斯推理的精确数学所规定的，正如本书后面将解释的那样。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210426204429_1b.webp" style="zoom: 67%;" />

**图2.1**   左上角的图显示导致结果的四种可能原因的可信度，其中标有 A、B、C 和 D 的原因相互排斥，并用尽了所有可能性。这些原因在一开始恰好是同样可信的；因此所有原因可信度都是0.25。左下角的图显示了当一个原因被认为不可能时的可信度，所得到的后验分布被用作中间一列图中的先验分布。在那里另一个原因 B 被认为是不可能的。从中间列开始的后验分布被用作最右列的先验分布。剩余的可能原因完全被贝叶斯的可信度的重新分配而影响。

该推理的相反形式也是贝叶斯的，被称为司法免责。假设一项犯罪有几个可能的罪魁祸首，并且这些嫌疑犯是相互独立的，并且用尽了所有可能性。如果有证据表明一个嫌疑犯是绝对有罪的，那么其他嫌疑犯将被宣告无罪。

这种形式的免责如图2.2所示。上面的图假设结果有四种可能的原因，分别标记为 A、B、C 和 D，且原因是相互排斥的，并且用尽了所有可能性。在犯罪嫌疑的上下文语境中，犯罪嫌疑人 A 实施犯罪的假设可信度代表该犯罪嫌疑人的有罪程度。在这种情况下，可能更容易考虑罪责，而不是可信度。在本例中，四个嫌疑犯之前的罪责被设置为相等，因此图2.2上部面板中的四个柱的高度都是0.25。假设新的证据确凿地表明嫌疑犯D是罪魁祸首。因为已知其他嫌疑人没有关联，所以他们被证明是无罪的，如图2.2的下部面板所示。在福尔摩斯演绎法下，这一免责不仅是直观的，而且也是贝叶斯推理的精确数学规定的，正如本书后面将解释的那样。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210426205902_c7.webp" style="zoom: 80%;" />

**图2.2**  上图显示了导致结果的四种可能原因的可信度。标有A、B、C 和 D 的原因是相互排斥的，用尽了所有可能性。这些原因在一开始恰好是同样可信的，因此所有的原因都有0.25的先验可信度。下图显示了当一个原因被发现要承担责任时的可信度。不承担责任的原因经过贝叶斯的可信度重新分配而被“免除”(即作为原因的可信度为零)。

### 2.1.1 数据是有噪声的，推理是有概率的

图 2.1 和图 2.2 的情况假设观察到的数据与候选原因有明确的、确定性的关系。例如：福尔摩斯可能在犯罪现场发现了脚印，并完全确定了鞋子的大小和类型，从而完全排除或牵扯到特定嫌疑人。然而，现实中数据与其原因之间只有概率关系。真实的侦探可能会仔细测量脚印和脚印的细节，但这些测量只会缩小了可能产生脚印的鞋子的范围。测量结果并不完美，脚印只是鞋子的不完整表现。原因(即鞋子)和测量结果(即脚印)之间的关系充满了随机变化。

在科学研究中，测量充满了随机性。外来的影响污染了测量，尽管付出了巨大的努力来限制它们的侵入。例如，假设我们对测试一种新药是否能降低人体血压感兴趣。我们随机将一些人分配到服用药物的试验组，我们随机将其他一些人分配到服用安慰剂的对照组。这一过程是“双盲”的，因此参与者和管理人员都不知道哪个人接受了药物或安慰剂(因为这些信息是由随机分配的代码指示的，该代码在数据收集后被解密)。我们连续几天每天在设定的时间测量参与者的血压。正如你可以想象的那样，任何一个人的血压都可能根据很多因素的影响而变化很大，比如锻炼、压力、最近吃的食物等等。血压的测量本身是一个不确定的过程，因为它依赖于检测加压袖子下的血液流动的声音。每个人的血压也有很大的不同。因此，由此产生的数据非常混乱，每个组内的差异很大，组间的重叠也很大。因此，药物组中会有许多测得的血压高于安慰剂组，反之亦然。从这两堆分散和重叠的数字中，我们想要推理出这两个群体之间的差异有多大，以及我们对这种差异能有多大的把握。问题是，对于药物和安慰剂之间的任何特定的真实差异，其可测量的效果只是一个随机的印象。

所有科学数据的值都有一定程度的“噪音”。数据分析技术旨在从噪声数据中推理潜在趋势。与夏洛克·福尔摩斯不同的是，福尔摩斯可以进行观察，完全排除一些可能的原因，而我们可以收集数据，只会逐渐调整一些可能趋势的可信度。我们将在书的后面看到许多现实的例子。贝叶斯分析的美妙之处在于，数学能够准确揭示在现实的概率情况下重新分配可信度的程度。

以下是数据有噪声时贝叶斯推理的简化说明。假设有一家充气弹力球制造商，这些球有四种离散的尺寸，即直径为1.0、2.0、3.0和4.0(按一定的距离刻度，如分米)。然而，即使对于一个单一尺寸的球，由于充气程度的随机性，制造过程也是相当多变的。因此，制造尺寸为3的球的直径可能为1.8或4.2，即使它们的平均直径为3.0。假设我们向工厂订购三个尺寸为2的球。我们收到三个球，并尽可能地测量它们的直径，发现这三个球的直径分别为1.77、2.23和2.70。从这些测量中，我们是否可以得出结论，工厂给我们寄来了3个2号的球，或者工厂寄错了3号或1号球，甚至是4号球？

图2.3显示了这个问题的贝叶斯答案。上图显示了四种可能的尺寸，蓝色线条位于位置1、2、3和4。这四种尺寸的先前可信度被设置为相等，高度为0.25，这表示工厂收到了三个球的订单，但可能完全忘记了订购的尺寸，因此任何尺寸都同样可能已发送。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210426211348_01.webp" style="zoom:50%;" />

在这一点上，我们必须指定球直径随机变化的形式。为了说明起见，我们假设球的直径以其制造的尺寸为中心，但可能会更大或更小，这取决于充气量的大小。图2.3中的钟形曲线显示了每种尺寸产生直径的概率。因此，以2号球为中心的钟形曲线表明，2号球的直径通常约为2.0个单位，但由于膨胀的随机性，可能会大得多，也可能小得多。图2.3中的水平轴充当球大小(即蓝色条)和测量直径(钟形分布所示)的标尺。

图2.3的下部面板显示了在水平轴上用圆圈表示的三个测量直径。你可以看到，测得的直径最接近于2号或3号，但钟形分布表明，即使是1号有时也能产生这些直径的球。因此，直观地说，考虑到数据，我们会说大小2是最可信的，但是大小3在某种程度上也是可能的，大小1是远程可能的，但是大小4是相当不可能的。贝叶斯分析准确地反映了这些直觉，如图2.3的下部面板所示。蓝色条的高度显示了四种候选尺寸之间可信度的精确重新分配。在给定数据的情况下，球大小为2的概率为56%，大小为3的球的概率为31%，大小为1的球的概率为11%，而大小为4的球的概率仅为2%。

根据球的“嘈杂”个体直径推理球的潜在制造尺寸类似于现实世界科学研究和应用中的数据分析。这些数据是潜在发电机的噪音指示器。我们假设了一系列可能的潜在因素，并从数据中推理出它们的相对可信度。

再举一个例子，考虑对人们进行非法药物使用测试。从人群中随机抽取一个人进行血液测试，检查是否含有非法药物。根据测试结果，我们推理这个人是否服用过这种药物。但是，至关重要的是，这项测试并不完美，它很嘈杂。这项测试产生假阳性和假阴性的可能性不小。我们还必须考虑到我们事先知道，这种药物只有一小部分人使用。因此，这组可能性有两个值：一个人使用药物或不使用药物。这两种可能性都有先验的可信度，这是基于之前对吸毒在人群中的普遍程度的了解。这些嘈杂的数据是药检的结果。然后，我们使用贝叶斯推理在各种可能性之间重新分配可信度。正如我们将在书中稍后定量看到的那样，即使在测试结果为阳性的情况下，使用药物的后验概率往往也令人惊讶地小，因为使用药物的先验概率很小，测试也很嘈杂。这不仅适用于药物使用测试，也适用于癌症等疾病的测试。贝叶斯推理在现实世界中的一个相关应用是检测电子邮件中的垃圾邮件。自动垃圾邮件过滤器通常使用贝叶斯推理来计算传入邮件是垃圾邮件的后验概率。

总而言之，贝叶斯推理的本质是在各种可能性之间重新分配可信度。可信度的分布最初反映了对可能性的先验知识，这可能是相当模糊的。然后观察新数据，并重新分配可信度。与数据一致的可能性会赢得更多的可信度，而与数据不一致的可能性则会失去可信度。贝叶斯分析是以逻辑连贯和精确的方式重新分配可信度的数学。

## 2.2 在贝叶斯描述性模型中，可能性是参数的结果

贝叶斯分析的一个关键步骤是定义一组可能性以实现可信度的分配。这是非常重要的一个步骤，因为除了我们在初始集合中包含的可能性之外，可能会有其他可能性。（例如：人行道上的潮湿可能是由太空外星人大哭造成的）。但我们通过选择一组覆盖我们兴趣范围的可能性来推动这一过程。在推理分析后，我们可以检查数据是否被考虑的集合中最可信的可能性很好地描述。如果数据似乎没有得到很好的描述，那么我们可以考虑扩大可能性。这一过程被称为**后验预测检验**，将在本书后面解释。

再来看看降压药的例子，其中一组服用药物，另一组服用安慰剂，然后测量血压。我们想知道两组的趋势有多大差异：一组的典型血压与另一组的典型血压之间的差异有多大，我们有多确信这种差异的大小？差异大小描述了数据，而我们的目标是评估哪些可能的描述更可信或更不可信。

数据分析通常从数据的一系列的候选描述开始。这些描述是一些刻画了数据中趋势和分布的数学公式。公式本身通常有一些数字（被称为参数值）用于确定数学公式的确切形状。您可以将参数看作模拟数据生成的数学设备上的控制旋钮。如果更改参数的值，它会更改模拟数据中的趋势，就像更改音乐播放器上的音量控制一样，它会更改播放器发出的声音的强度。

在以前的统计学或数学研究中，你可能遇到过所谓的正态分布，这是一种钟形分布，通常用来描述数据。上面充气弹力球的例子提到了这一点（见图 2.3 ）。正态分布有均值和标准差两个参数。平均值是正态分布数学公式中的一个控制钮，它控制分布的中心趋势所在位置，有时也被称为位置参数。标准差是正态分布数学公式中的另一个控制钮，用于控制分布的宽度或离散度，有时也被称为刻度参数。**正态分布公式将参数值转换为数据值概率的特定钟形。**

图 2.4 显示了一些叠加了候选正态分布的数据。数据显示为直方图，它绘制垂直条形图，这些条形图的高度指示有多少数据落入该条形图所覆盖的小范围内。直方图看起来大致是单峰的，左右对称。上面的图以正态分布的形式叠加数据的候选描述，该正态分布的平均值为 10，标准差为 5。这种参数值的选择似乎很好地描述了数据。下面的图显示了另一个参数值选择，平均值为8，标准差为6。虽然这种候选描述看似合理，但不如上面的面板好。

贝叶斯推理的作用是**在考虑候选参数值的先验概率同时，计算候选参数值的确切相对可信度**。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210426211630_4b.webp" style="zoom:50%;" />

在实际应用中，候选参数值可以形成一个无限的连续体，而不仅仅是几个离散选项。正态分布的位置参数可以采用从负到正无穷大的任意值。贝叶斯推理在无限连续体上无故障运行。

对于数据的数学描述有两个主要要求。

首先，数学形式应该是可理解的，并带有有意义的参数。用我们不懂的数学形式来描述数据，用我们无法解释的参数来描述数据是徒劳的。例如，在正态分布的情况下，均值参数和标准差参数作为分布的位置和尺度有直接意义。在本书中，我们将使用具有有意义的参数的数学描述。因此，贝叶斯分析在由所选模型定义的有意义的可能性空间内的参数值之间重新分配可信度。

数学描述的第二个要求是，它应该在描述上是足够的，这意味着，大致来说，数学形式应该“看起来像”数据。在数据趋势和模型形式之间不应该有任何重要的系统性差异。决定一个明显的差异是重要的还是系统的并不是一个确定的过程。在研究早期阶段，我们可能会满足于对数据的粗略、“足够好”的描述，因为它捕捉到了有意义的趋势，与以前的知识相比，这些趋势是有趣和新颖的。随着研究领域的成熟，我们可能需要越来越准确的数据描述。贝叶斯分析对于评估不同候选数据描述的相对可信度非常有用。

同样重要的是要理解，数据的数学描述不一定是数据的因果解释。可以说，图 2.4 中的数据符合均值为 10 的正态分布，标准差为 5 并不能解释是什么过程导致数据出现这种形式。这些参数只有在正态分布定义的数学形式背景下才是“有意义的”；参数值本身对于原因没有必要的意义。在某些应用中，数学模型可能是对生成数据的自然过程的描述，因此参数和数学形式可以引用世界上假定的状态和过程。例如，在充气弹力球的情况下（图2.3），候选参数值在制造商处被解释为“尺寸”，潜在尺寸与随机膨胀相结合，导致观察到的数据值。但是，仅仅为了描述数据样本中的趋势，引用物理状态或过程并不是必需的。在本书中，我们将重点介绍如何使用可直观访问的模型表单来描述通用数据，这些模型表单可广泛应用于多个领域。

## 2.3 贝叶斯数据分析的步骤

一般而言，数据的贝叶斯分析遵循以下步骤：

1. 确定与研究问题相关的数据。这些数据的衡量尺度是什么？哪些数据变量需要被预测，哪些数据变量应该充当预测者？
2. 定义相关数据的描述性模型。数学形式及其参数应该是有意义的，并且符合分析的理论目的。
3. 指定参数的先验分布。先验假设必须通过听众的检阅，例如一些持怀疑态度的科学家。
4. 使用贝叶斯推理在参数值之间重新分配可信度。就理论上有意义的问题解释后验分布(假设模型是对数据的合理描述；请参阅下一步)。
5. 检查后验预测是否以合理的精度模拟数据（即进行“后验预测检验”）。如果不是，那么考虑采用一个不同的描述性模型。

也许解释这些步骤的最好方法是用贝叶斯数据分析实际的例子。出于介绍性的目的，下面的讨论消减了许多技术细节。在这个例子中，假设我们对人的体重和身高之间的关系感兴趣。我们从日常经验中怀疑，高个子往往比矮个子的人更重，但我们想知道，随着身高的增加，人们的体重会增加多少，我们对增加的幅度能有多大把握。特别是，我们可能对根据身高预测体重感兴趣。

**第一步是确定相关数据**。

假设我们已经能够收集57名成年人的身高和体重，这些成年人是从感兴趣人群中随机抽样的。身高是以英寸为连续刻度单位，体重是以磅为连续刻度单位。我们希望根据身高预测体重。数据的散点图如图 2.5 所示。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210426211911_96.webp" style="zoom: 67%;" />

**第二步是定义对我们的研究目标有意义的、有关数据的描述性模型。**

在这一点上，我们只对确定体重和身高之间的基本趋势感兴趣，认为体重可能与身高成正比，至少是作为成年人体重和身高范围的近似值，这并不荒谬。因此，我们将预测体重描述为某个乘数乘以身高，再加上基数。我们将预测体重表示为 $\hat y$ ，并将身高表示为 $x$ 。然后，预测体重是身高倍数加上基数的想法可以用数学方法表示如下：
$$
\hat{y}=\beta_{1} x+\beta_{0} \tag{2.1}
$$
系数 $\beta_1$ 表示身高增加一英寸时预测体重增加多少。基数在方程式2.1中表示为 $\beta_0$ ，它的值表示零英寸高的人的体重。你可能会认为基数值应该是零，即一个先验，但这不一定能够描述成年人体重和身高之间的关系，因为成年人的身高值只有一个有限的范围，且远远高于零。方程 2.1 是直线的形式，其中 $β_1$ 是斜率，$β_0$ 是截距，这种趋势模型通常被称为线性回归。

这个模型还不完整，因为我们必须描述实际体重围绕预测体重的随机变化。为简单起见，我们使用正态分布，并假设实际体重 $y$ 是围绕预测值 $\hat y$ 的正态随机分布，标准偏差表示为 $\sigma$ 。这种关系被象征性地表示为:
$$
y \sim \operatorname{normal} (\hat y, \sigma )\tag{2.2}
$$
其中符号“∼”的意思是“作为...“。公式 2.2 表示，接近 $\hat y$ 的 $y$ 值是最有可能的，而高于或低于 $\hat y$ 的 $y$ 值是不太可能的。$\hat y$ 附近概率的下降由正态分布的形状决定，其宽度由标准偏差 $σ$ 指定。

完整的模型，结合公式 2.1 和 2.2 ，总共有三个参数：斜率 $\beta_1$ ，截距 $\beta_0$ ，以及“噪声”的标准差 $\sigma$ 。请注意，这三个参数很有意义。特别是，斜率参数告诉我们当身高增加一英寸时，重量倾向于增加多少，而标准偏差参数告诉我们，在预测值附近重量有多大的变异性。

**第三步是指定参数的先验分布。**

我们或许能够通过先前进行的、可公开核实的、关于目标人群的体重和身高的研究来作为先验知识。或者我们可以通过互动，谨慎地选择一个能够达成共识的先验。本例将使用一个不明确且模糊的先验，对斜率和截距的大量可能值（两者都以零为中心）给予几乎相等的先验可信度。我还将在噪声(标准差)参数上设置一个模糊且不明确的优先级，具体地说，是一个从零扩展到一个巨大值的均匀分布。这种先验分布的选择意味着它实际上对结果的后验分布没有偏置影响。

**第四步是解释后验分布。**

贝叶斯推理在参数值之间重新分配了可信度，从模糊的先验分布到与数据一致的值。后验分布表示是 $\beta_0、\beta_1$ 和 $σ$ 的组合，在给定数据情况下，这些组合一起是可信的。图 2.5 的右图显示了斜率参数 $\beta_1$ 的后验分布。重要的是要理解，**图 2.5 右图显示的是参数值的分布，而不是数据的分布。**图2.5的右图中，蓝条表示候选斜率值在连续定义域中的可信度，类似图 2.1 到图 2.3 中的蓝条。

图 2.5 中的后验分布表明，斜率的最可信数值约为4.1，这意味着身高每增加1英寸，体重就增加约4.1磅。后验分布也显示了估计斜率的不确定性，因为该分布显示了整个连续定义域中值的相对可信度。总结不确定性的一种方法是标记最可信且覆盖95%分布的值的范围。这称为最高密度间隔（HDI），由图2.5中底部的黑条标记。95% HDI 内的值比 HDI 外的值更可信（即具有更高的概率“密度”），并且 HDI 内的值总概率为95%。给出57个数据点，95% 的 HDI 从大约 2.6 磅/英寸的斜率到大约5.7磅/英寸的斜率。有了更多的数据，对坡度的估计会更精确，这意味着 HDI 将会更窄。

图 2.5 还显示了后验分布中零斜率的位置。在该情况下，零远远超过了斜率的任何可信值，因此我们可以决定“拒绝”零斜率作为身高和体重之间关系的一个似是而非的描述。但这种关于零状态的离散决策与贝叶斯分析本身是分开的，贝叶斯分析本身提供了完整的后验分布。

许多读者可能以前了解过零假设显著性检验（NHST），它涉及汇总统计量的抽样分布，如 $t$ 分布，以用于计算 $p$ 值。（如果不知道这些术语，请不要担心，NHST将在第11章中讨论。重要的是要理解，图 2.5 中的后验分布不是抽样分布，与 $p$ 值无关。）

理解后验分布的另一种方法是通过数据的散点图绘制可信的回归线。图 2.5 的左图显示了来自后验分布的几条可靠的回归线。每条线绘制 $\hat y= \beta_1x+\beta_0$ ，表示 $\beta_1$ 和 $\beta_0$ 的可靠组合。在给定数据的情况下，这些线束显示了一系列比较可信的可能性，而不是只画出一条“最佳”线条。

**第五步是检查具有最可信参数值的模型是否确实合理地模拟了数据。**

这被称为“后验预测检验”。没有单一的、唯一的方法来确定模型预测是否系统地和有意义地偏离数据，因为有无数种方法来定义系统偏差。一种方法是根据实际数据绘制模型中预测数据的汇总。我们取参数的可信值 $\beta_1、\beta_0、  \sigma$ ，将它们插入到模型方程2.1 和 2.2 中，并在选定的 $x$ 值（身高）处随机生成模拟的 $y$ 值(体重)。我们对很多可信的参数值这样做，以根据模型创建数据的代表性分布。此模拟的结果如图 2.6 所示。预测的体重值由竖线汇总，显示95%最可信的预测体重值的范围。每条中间的圆点显示预测体重值的平均值。通过对图表的目视检查，我们可以看到，预测数据似乎很好地描述了实际数据。实际数据似乎没有系统性地偏离模型预测的趋势或区间。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210426213256_ea.webp" style="zoom:67%;" />

如果实际数据确实系统地偏离了预测的形式，那么我们可以考虑调整描述性模型。例如，实际数据可能呈现非线性趋势。在这种情况下，我们可以扩展模型以包括非线性趋势。在贝叶斯软件中这样做很简单，而且很容易估计描述非线性趋势的参数。我们还可以检查数据的分布特性。例如，如果数据相对于正态分布预测的数据似乎有异常值，我们可以将模型更改为使用重尾分布，这在贝叶斯软件中同样是直接的。

我们已经在一个相当真实的案例中看到了贝叶斯分析的五个步骤。本书解释了如何针对许多不同应用程序和描述性模型类型进行此类分析。有关比较两组的贝叶斯分析的简短但详细的介绍，以及对经典 $t$ 检验的危险的解释，请参见 Kruschke(2013a) 的文章。有关应用于多元线性回归的贝叶斯分析的介绍，请参阅 Kruschke、Aguinis 和 Joo(2012)的文章。有关后验预测检验的观点，请参阅 Kruschke 的文章(2013b)和本书的17.5.1节(以及其他)。

### 2.3.1 没有参数模型的数据分析？

如上所述，贝叶斯数据分析基于有意义的参数化描述性模型。那是否存在此类模型不能使用或不需要使用的情况呢？

似乎不使用参数化模型的一种情况是所谓的非参数模型。但这些模型的名字令人困惑，因为它们实际上确实有参数；事实上，它们可能有无限数量的参数。举个简单的例子，假设我们要描述狗的重量。我们测量从所有狗品种中随机抽取的许多不同狗的体重。体重可能不是单峰分布的，而是不同品种的狗可能有不同的体重亚群。但是，一些不同的品种可能有几乎相同的体重分布，还有许多狗不能被识别为特定品种，随着我们从越来越多的狗那里收集数据，我们可能会遇到新的亚群成员，这些成员还没有包括在之前收集的数据中。因此，不清楚我们应该在描述性模型中包括多少集群。取而代之的是，我们从数据中推理出不同集群的相对可信度。由于每个群集都有自己的参数（如位置和比例参数），因此模型中的参数数量会被推理出来，并且可以随着无限的数据增长到无穷大。还有许多其他类型的无限参数化模型。有关贝叶斯非参数模型的教程，请参阅 Gershman和Blee(2012)；有关最近的评论，请参阅 Müller 和 Mitra(2013) ；有关教科书应用，请参阅 Gelman 等人。(2013年)。我们不会在本书中考虑贝叶斯非参数模型。

在某些情况下，乍一看似乎没有适用的参数化模型，例如：如果疾病的诊断测试呈阳性，则计算出一个人患有某种罕见疾病的可能性。但贝叶斯分析即使在这里也适用，尽管参数指的是离散状态，而不是连续分布。在疾病诊断的情况下，该参数是个人的潜在健康状态，并且该参数可以有两个值之一，即“有疾病”或“没有疾病”。贝叶斯分析根据观察到的测试结果重新分配这两个参数值的可信度。这与福尔摩斯在图 2.1 中考虑的离散可能性完全相似，不同之处在于测试结果产生的是概率信息，而不是完全确凿的信息。我们将在第 5 章中对这类情况进行精确的 贝叶斯计算（具体见表 5.4）。

在某些情况下，分析师可能不愿意使用任何数据的参数化模型，即使是非常灵活的无限参数化模型。如果是这种情况，那么贝叶斯方法就不能应用了。然而，这种情况很少见，因为数学模型是非常有用的工具。试图在不使用模型的情况下从数据中做出推理的一种情况是来自 NHST 的一种方法，称为重采样或自举(Bootstrapping) 。这些方法计算 $p$ 值以做出决策，$p$ 值具有基本的逻辑问题，将在第 11 章中讨论。这些方法表达数据特征的确定性程度的能力也非常有限，而贝叶斯方法则将不确定性的表达放在最前面和中心。

## 2.4 习题

【请在https://sites.google.com/site/doingbayesiandataanalysis/上寻找更多练习】。

**练习2.1 [目的：让你主动操纵概率的数学模型]。** 假设我们有一个棋盘游戏的四面骰子。在四面体模具上，每个面都是一个等边三角形。当你掷骰子时，它落在地上，一个面朝下，另外三个面看起来就像一个三面棱锥体。面的编号为 1 ~ 4 ，底面的值（作为聚集点）打印在所有三个可见面的底边。将底面的值表示为 $x$ 。考虑以下三种概率的数学描述：$p(x)=1/4$ 。模型B：$p(x)=x/10$ 。模型C：$p(x)=12/(25x)$。 对于每个模型，确定每个 $x$ 的值对应的 $p(x)$值。用语言描述每个模型所表达的偏向(或不偏向)。

**练习2.2 [目的：让您积极思考数据如何导致可信度发生变化]**。假设我们有上一个练习中介绍的四面体骰子，以及骰子概率的三个候选模型。假设一开始，我们不确定应该相信骰子的什么。一方面，骰子可能是公平的，每个面落地的概率都是相同的。另一方面，骰子可能会有偏差，点越多的面越容易落下（因为这些点是通过在骰子中嵌入沉重的珠宝来创建的，因此点较多的边更有可能落在底部）。另一方面，骰子可能会有偏差，因为面上的点越多，它落下的可能性就越小（因为可能点是有弹性的橡胶或从表面突出）。最初，我们对这三种模型的信念可以描述为 $p(A)=p(B)=p(C)=1/3$ 。现在我们掷骰子 100 次，结果是：$\#1=25，\#2=25，\#3=25，\#4=25$ 。这些数据是否改变了我们对模型的看法？哪种模式现在看起来最有可能？假设当我们掷骰子 100 次时，我们发现这些结果： $\#1=48，\#2=24，\#3=16，\#4=12$ 。现在看起来哪种模式最有可能？