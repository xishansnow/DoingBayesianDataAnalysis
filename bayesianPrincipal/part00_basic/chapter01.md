# 第一章  内容简介

<style>p{text-indent:2em}</style>

## 1.1 真实的人可以阅读这本书

这本书解释了如何通过真实的人(比如你)对真实的数据(比如你的)进行贝叶斯数据分析。这本书从基础开始，介绍了概率和编程的基本概念。你不需要已经知道统计和编程。这本书发展到用于现实数据分析的高级层次模型。这本书是对一个人说的，比如一年级研究生或社会或生物科学的高级本科生:一个在W obegon湖长大的人，但他不是那个神话中的人，他以前受过核物理学家的训练，然后决定学习贝叶斯统计。(第一版出版后，那些神话生物中的一个联系我关于这本书！所以，即使你以前受过核物理学家的训练，我希望这本书也能告诉你。)

先决条件的细节和这本书的内容如下。但首先要注意的是:正如你可能从这一章的开头就注意到的，这几章以一节由一位著名诗人创作的优雅而富有洞察力的诗句开始。四行诗由四拍子组成，或者通俗地说，是“乡村华尔兹”拍子。这些诗歌通过引用华尔兹计时中不朽的人类主题来关注本章的概念主题。

>   ```
>   If you do not find them to be all that funny ,
>   If they leave you wanting back all of your money ,
>   W ell, honey , some waltzing’s a small price to pay , for
>   All the good learning you’ll get if you stay 
>   ```

### 1.1.1 先决条件

做数据分析没有回避数学。另一方面，这本书肯定不是数理统计教科书，因为它不强调定理证明或形式分析。6但我确实预计你在阅读这本书时对基础微积分的了解很模糊。比如你理解像？xdx =1 2x2，你可能可以走了。注意前一句说的是“理解”积分的说法，而不是自己“生成”这个说法。当数学推导有助于理解时，它们通常会呈现出一系列完整的中间步骤，因此你实际上可以在离开时感到安全，熟悉旅行和目的地，而不仅仅是在被蒙住眼睛扔进后座并高速绕着弯道行驶后感到晕车。

如果你有一些计算机编程的基本经验，你的旅程的开始会更顺利，但是以前的编程经验并不重要。计算机程序只是计算机可以执行的命令列表。例如，如果您曾经在Excel电子表格单元格中键入等号，那么您已经编写了一个编程命令。如果你曾经用Java、C、Python、Basic或任何其他计算机编程语言写了一个命令列表，那么你就准备好了。我们将使用被称为R、JAGS和斯坦的编程语言，这些语言是免费的，并在本书中进行了全面的解释。



## 1.2 这本书里有什么

这本书有三个主要部分。第一部分涵盖基础：贝叶斯推理的基本思想、模型、概率和R中的编程。第二部分涵盖现代贝叶斯数据分析的所有关键思想，同时使用最简单的数据类型，即二分法数据，如同意/不同意、记住/忘记、男性/女性等。因为数据非常简单，所以重点可以放在贝叶斯技术上。特别是对“马尔可夫链蒙特卡罗”(MCMC)的现代技术进行了深入而直观的解释。由于本书这一部分的数据保持简单，关于分层模型的含义的直觉可以在精彩的图形细节中得到发展。这本书的第二部分还探讨了计划需要多少数据才能在结论中达到所需的精确度的方法，也就是广为人知的“功率分析”。

本书的第三部分将贝叶斯方法应用于真实数据。应用程序围绕要分析的数据类型以及用于解释或预测数据的测量类型进行组织。不同类型的测量尺度需要不同类型的数学模型，但除此之外，基本概念总是相同的。下面提供了更多覆盖范围的详细信息。

这本书的章节被设计成按顺序阅读，进行基本的应用贝叶斯分析的“盛大之旅”。特别是通过第一部分和第二部分，如果按顺序阅读，这两章可能最有意义。但如下面所述，更短的路线是可能的。

### 1.2.1 你很忙。你至少应该读哪些？

下面是本书的极简主义短途旅行：

-   第2章：贝叶斯推理的思想和模型参数。本章介绍重要的概念，不要跳过它。
-   第3章：R编程语言。阅读有关安装软件的部分，包括本书附带的大量程序。其余的可以略读，然后在需要的时候返回。
-   第4章：概率的基本概念。如果你很有可能已经知道了这一章的内容，只需略读一下。
-   第5章：贝叶斯规则！
-   第6章：贝叶斯规则的最简单的正式应用，在本书的其余部分中都有引用。
-   第7章：MCMC方法。本章解释了使现代贝叶斯应用成为可能的计算方法。你不需要研究所有的数学细节，但你应该确保掌握了图片的大意。
-   第8章：实现MCMC的JAGS编程语言。
-   第16章：两组的贝叶斯估计。前述章节中的所有基本概念都适用于比较两组的情况。

### 1.2.2 你真的很忙！你能读的就更少了吗？

如果你想要的只是概念基础和尽可能快的动手经验，如果你有一些经典统计学的前期知识，比如t检验，那么我推荐如下。首先，阅读本书的第2章，了解概念基础。然后阅读Kruschke (2013a)的文章，这篇文章描述了两组的贝叶斯估计(类似于传统的t检验)。本质上，你已经跳到了这本书的第16章。为了您的动手体验，文章有附带的软件，并且有一个已经用JavaScript实现的版本，可以在您的web浏览器中使用，不需要安装其他软件。详情请见We b s I t e http://www . Indiana . edu/~ kruschke/BEST/。

### 1.2.3 你想多欣赏一会儿风景。但不会太久

在上面建议的极简主义之旅之后，如果您想深入研究更具体的应用程序，您将需要阅读以下部分：

-   第9章：分层模型。许多实际应用程序都涉及分层或“多层”结构。让贝叶斯方法如此激动人心的一件事是它们对分层模型的无缝适用性。·
-   第15章：广义线性模型概述。要知道哪种类型的模型可能适用于您的数据，您需要了解传统模型的规范目录，其中许多模型属于广义线性模型。
-   第16至24章中的各个章节。请转到与您感兴趣的数据结构相关的章节(您将会理解这一章，因为您以前读过第15章)。
-   第13章：从贝叶斯角度进行统计力量分析和研究规划。第一次阅读时，这一章不是必不可少的，但不要永远跳过这一章，这一点很重要。毕竟，不做计划就是计划失败。
-   25.1节，对如何报告贝叶斯分析提出了建议。如果你想让你的研究影响其他人，你必须能够告诉他们。

### 1.2.4 如果你只是想拒绝一个零假设

传统的统计方法通常专注于拒绝零假设，而不是估计大小及其不确定性。要想从贝叶斯的角度看待零假设，请阅读以下章节：

-   第11章：传统零假设显著性检验中p值的危险。
-   第12章：零假设评估的贝叶斯方法。

### 1.2.5 在这本书中，传统检验X的等价物在哪里？

由于许多读者将在已经接触到强调零假设显著性检验(NHST)的传统统计之后来到这本书，这本书为NHST教科书中的许多常见主题提供了贝叶斯方法。Ta b l e 1.。1列出了标准入门统计教科书所涵盖的各种测试，以及它们在本书中的贝叶斯类似物的位置。

INTA b l e 1提到的一系列测试。1都是所谓的“广义线性模型”。“。对于那些已经熟悉这个术语的人，您可以向前浏览一下Table15.3，第444页，看看哪些章节涵盖了哪些案例。对于那些还不熟悉这个术语的人，不要担心，因为第15章的全部内容都是专门介绍和解释这些概念的。

来自Ta b l e 1的一个肤浅的结论。1可能是，“哎呀，表格显示传统的统计检验在每种情况下都会做一些类似于贝叶斯分析的事情，所以费心去做贝叶斯分析是没有意义的。“。这样的结论是错误的。首先，传统的NHST存在深层次的问题，其中一些问题将在第11章中讨论。其次，贝叶斯分析比NHST产生更丰富、更有信息的推论，本书将通过大量例子说明这一点。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/bayesian_stat_20210427182257c7.webp" style="zoom:67%;" />

## 1.3 第二版有什么新内容？

主题的基本进程与第一版相同，但所有细节都发生了变化，从一个封面到另一个封面。这本书和它的程序都被完全重写了。以下是这些变化中的几个亮点：

-   Jags和Stan中的所有新程序。新的程序被设计成比第一版的脚本更容易使用。特别值得一提的是，现在有了紧凑的高级脚本，可以方便地在您自己的数据上运行这些程序。这个新的节目本身就是一项重大的事业。
-   导论第二章，关于贝叶斯推理如何跨可能性重新分配可信度的基本思想，完全重写并大大扩展了。
-   有关于编程语言R(第3章)、JAGS(第8章)和Stan(第14章)的全新章节。关于R的新章节篇幅很长，包括对数据文件和结构(如列表和数据框)的解释，以及几个实用函数。(它还有一首新诗，我特别喜欢。)。关于JAG的新一章包括对在并行计算机内核上执行JAG的RunJAGS包的解释。关于斯坦的新一章对哈密顿蒙特卡罗的概念提供了一个新颖的解释。在Stan和Jabg之间的程序流中，c h a p t e r o n S t a n a l s o e x p l a i n s c o n c e p t u a l不同。
-   第五章对贝叶斯规则进行了大幅修订，重新强调了贝叶斯规则如何从之前到后验重新分配参数值的可信度。有关模型比较的材料已从所有早期章节中删除，并整合到第10章中的紧凑介绍中。
-   关于Metropolis算法和Gibbs抽样的两个单独章节已合并为关于MCMC方法的单个章节(如第7章)。
-   在第7章和第8章中有大量关于MCMC收敛诊断的新材料。对自相关和有效样本大小进行了解释。还探讨了最高密度区间(HDI)极限估计的稳定性。新的计算机程序也会显示诊断结果。
-   关于分层模型的第9章包括了大量关于收缩这一关键概念的新的、独特的材料，以及新的例子。
-   所有关于模型比较的材料，在第一版中分布在不同的章节中，现在合并成一个集中的章节(第10章)，强调其作为分层建模案例的概念化。
-   对关于零假设显著性检验的第11章进行了广泛修订。为引入抽样分布的概念提供了新的素材。对于不同的停止规则和多个测试，它都有新的抽样分布图示。
-   第12章，关于空值评估的贝叶斯方法，有了关于实际等价域(ROPE)的新材料，用贝叶斯因子接受空值的新例子，以及用Savage-Dickey方法对贝叶斯因子的新解释。
-   第13章，关于统计能力和样本量，有一个广泛的关于序贯检验的新章节，并建议将研究目标定为估计的精确度，而不是拒绝或接受一个特定值。
-   对介绍广义线性模型的第15章进行了全面修订，用更完整的表格显示了预测变量类型和预测变量类型的组合。
-   第16章，关于平均数的估计，现在包括比较两组的广泛讨论，以及对效应大小的明确估计。
-   第17章关于单一指标预测的回归，现在包括了Jags和Stan中稳健回归的大量例子。分层回归的新例子，包括二次趋势，用图形说明了单个坡度和曲率估计的收缩。文中还对加权数据的使用进行了说明。
-   第18章，关于多元线性回归，包括一个关于贝叶斯变量选择的新章节，在这一章节中，各种候选预测因子被概率地包括在回归模型中。
-   第19章关于单因素ANOV A类分析，有所有新的例子，包括一个完全设计好的类似于协方差分析(ANCOVA)的例子，以及一个涉及异质性方差的新例子。
-   第20章关于多因素类方差分析，有所有新的例子，包括一个完整的分裂图设计例子，它涉及受试者内部因素和受试者之间因素的组合。
-   第21章，关于Logistic回归，扩展到包括稳健Logistic回归的示例，以及带有定类预测值的示例。
-   多项Logistic回归有一个全新的章节(第22章)。本章填补了第一版中缺失的广义线性模型(即定类预测变量)的一个案例。
-   关于定序数据的第23章大大扩展了。新的例子说明了单组和两组分析，并展示了解释与将有定序据视为度量数据有何不同。
-   有一个新的章节(25.4)解释了如何在JAG中对被审查的数据进行建模。
-   很多练习都是新的或修改过的。

哦，我有没有提到封面不一样？狗与贝叶斯法则的对应关系现在变得清晰起来：后狗的折叠耳朵是可能性狗和先前狗的活泼耳朵和松软耳朵之间的折衷。在MCMC方法中，通常不计算边际似然，因此分母中的狗变得昏昏欲睡，无所事事。我希望这本书的封面之间的东西像封面上的狗一样友好和迷人。

## 1.4 给我反馈(礼貌一点)

我已经为这本书工作了几千个小时，我想把它做得更好。如果您对本书的任何方面有任何建议，请发送电子邮件给我：johnkruschke@gmail.com。如果你发现了严重的错误或无伤大雅的错误，打字错误或思想错误，请告诉我。如果你对如何澄清某事有什么建议，请告诉我。特别是让我知道，如果你有一个好的例子，可以让事情变得更有趣或更相关。我感兴趣的是来自研究的完整原始数据，这些数据让广大观众感兴趣，可以在确认的情况下使用，但不收费。如果你有比我拼凑起来的更优雅的编程代码，也请告诉我。这些页面的页边空白处被故意加宽，这样你在给我的电子邮件中将你的嘲讽和称谓重新措辞成友好的建议之前，就有空间写下来了。押韵的对联特别受欢迎。

自从第一版出版以来，我已经收到了数百封来自读者的电子邮件。我已经回复了许多人，但我真的很尴尬，因为我不能回复所有的人，有些人没有得到承认。如果我没有及时回复你的电子邮件，你的信息很可能被雪崩般的后续电子邮件淹没了。欢迎您发一封后续电子邮件，试图激起我的回应。在任何情况下，如果你的电子邮件很长，或者有附件，或者在你正在尝试的一些复杂的分析中询问问题，我很可能会对自己说，“这很有趣，但等我有更多的时间再回复时，我会考虑一下。”“。然后，不管现在是什么时候，晚一点都不会来。不管我能不能回复，我都很感谢你的留言

## 1.5 谢谢!

我要感谢许多读者，他们在Amazon.com、Goodreads.com、博客和社交网站等网站上发布了第一版的评论和建议。在写这篇文章的时候，亚马逊网站上有46条评论，亚马逊网站上只有6条评论。Co.uk(联合王国)，Amazon.ca(加拿大)2个，Amazon.cn(中国)1个。Goodreads.com上有4条评论，还有很多评分。很多人在他们的博客上评论或推荐了这本书。很多人在社交网站上对这本书大加赞赏。我非常感谢你们所有人抽出时间来写评论，并很高兴你们的评论总体上都是非常积极的！我希望这第二版能引起持续的冲动，对第二版发表新的评论，因为修订已经做出了巨大的努力，让这本书变得更好。

我也感谢第一版的专业评论的作者，包括安德鲁斯(2011)，巴里(2011)，科尔文(2013)，丁(2011)，费林厄姆(2012)，戈尔茨坦(2011)，史密森(2011)，V Anpaemel and T uerlinckx(2012)。我对我错过的任何评论者表示歉意，请让我知道。我认为提高贝叶斯方法在专业领域的知名度是有价值的，我非常感谢所有这些作者花时间和精力撰写评论。

有几个人编写了计算机程序，扩展或改进了与该书第一版相关的程序。特别地，两组的贝叶斯估计程序(“最佳”；Kruschke，2013a，比照.。这本书的第16章)由Mike Meredith用R重新打包，Rasmus Bóth用JavaScript重新打包，Andrew Straw用Python重新打包。有关他们作品的链接，请访问http://www.Indiana.edu/~Kruschke/Best/。创建层次结构图的系统，类似于图9.13(p.252)，是由Rasmus Bóth为LibreOffice和R创建的，由Tinu Schneider为Laex和TikZ创建的。有关他们工作的链接，请参见http://doingbayesiandataanalysis.blogspot.com/2013/10/-for-Hierarchy-Models-New.html图表。感谢你们为使贝叶斯方法为更广泛的受众所做的广泛努力和贡献。

很多同事都组织过进行贝叶斯数据分析的研讨会或课程。研讨会列表显示在https://sites.google.com/site/上，正在进行bayesiandata分析/。每一次研讨会的参与者都比我在这里提到的要多得多，但他们包括密歇根大学政治和社会研究暑期项目大学间联盟的威廉·雅各比(William Jacoby)和迪特尔·伯雷尔(Dieter Burrell)；印第安纳大学社会科学研究中心(Indiana University Social Science Research Commons)的威廉·普里德莫尔(William Pridemore)、詹姆斯·罗素(James Russell)、詹姆斯·W·阿尔克(James W Alker)和杰夫·德维特(Jeff DeWitt)；瑞士圣加伦大学(University of St.Gallen)实证研究方法暑期学校的汉斯-约阿希姆·克诺夫(Hans-Joachim Knopf)；威斯康星大学麦迪逊分校的约翰·柯廷；德堡大学的迈克尔·罗伯茨和他的同事，包括切斯特·福纳里、布莱恩·汉森和温贝托·巴雷托；明文安的简·安德鲁斯和他在V Assar学院的同事；塞顿霍尔大学的凯利·戈德特和同事；普渡大学的格雷戈里·弗朗西斯和齐格蒙特·皮兹洛；索非亚新保加利亚大学的博伊科·科基诺夫和同事；心理学计算机学会的胡贤恩和迈克尔·琼斯。我向那些我无意中从这份名单上漏掉的人道歉。我感谢你们所有人的时间和努力。我希望这些研讨会和课程能真正促进与会者进行贝叶斯数据分析。

这本书已经被一些讲师在他们的课程中使用，他们中的一些人给我发来了他们的经验笔记。尤其是，奥伯林学院的杰弗里·威特默发表了广泛的评论。加州大学圣克鲁斯分校的阿德里安·布拉索维亚努(Adrian Brasoveanu)和W阿什顿大学(University Of W Ashington)的约翰·宫本(John Miyamoto)也传达或发布了有关他们课程的信息。V anpaemel和T uerlinckx(2012)的评论报告了课堂使用的经验。感谢所有在课程中大胆尝试第一版的讲师。我希望第二版对课堂和自学更有用。

近几年来，我的班上有很多学生发表了很有见地的意见和建议。其中包括Young Ahn，Gregory Cox，Junyi Dai，Josh de Lueew，Andrew Jahn，Arash Khodadadi和T Orrin Liddell。还要感谢T Orrin Liddell帮助检查这本书的校样。我感谢安妮·斯坦迪什(Anne Stanish)为本书的博客研究并推荐了一个论坛。我很感谢很多人在博客和论坛上留下了深思熟虑的评论。还要感谢几位细心的读者，他们报告了第一版中的错误。感谢雅各布·霍兹(Jacob Hodes)对贝叶斯分析如此感兴趣，他将前往一个会议与我讨论这个问题。

这本书的第一版花了6年时间，在此期间，许多同事和学生提供了有益的意见。最广泛的评论来自路易斯·佩索亚、迈克尔·卡里什、杰罗姆·布斯迈耶和亚当·克拉维茨；谢谢大家！迈克尔·埃里克森(Michael Erickson)、罗伯特·诺索夫斯基(Robert Nosofsky)、杰夫·艾弗森(Geoff Iverson)和詹姆斯·L·麦克莱兰(James L.。这本书的许多部分都间接受益于与W oojae Kim、Charles Liu、Eric-Jan W经纪人和Jeffrey Rouder的交流。T Eresa Treat和Michael Trosset等公司提供了指向数据集的指针。Michael D提供了非常受欢迎的支持性反馈。李，还有阿黛尔·迪德里奇(Adele Diederich)。理查德·希夫林(Richard Shiffrin)、杰罗姆·布斯迈耶(Jerome Busemeyer)、彼得·托德(Peter T Odd)、詹姆斯·汤森(James T Ownsend)、罗伯特·诺索夫斯基(Robert Nosofsky)和路易斯·佩索亚(Luiz Pessoa。其他部门同事一直非常支持将贝叶斯统计学纳入课程，包括琳达·史密斯(Linda Smith)和艾米·霍兹沃斯·门罗(Amy Holtzworth-Munroe)。各式各样的助教提供了有益的意见；我特别感谢诺亚·西尔伯特和托马斯·怀斯的出色帮助。随着这本书多年来的发展，许多学生提出了一些建议，包括亚伦·阿尔宾(Aaron Albin)、托马斯·史密斯(Thomas Smith)、肖恩·马修斯(Sean Matthews)、托马斯·帕尔(Thomas Parr)、吉田健二(Kenji Yoshida)、布莱恩·伯格特(Bryan Bergert)，或许还有其他几十个人提出了有洞察力的问题或评论，帮助我调整了书中的陈述。

感谢R(R Core T eam，2013)、RStudio(RStudio，2013)、Jags(Plummer，2003,2012)、RunJAGS(Denwood，2013)、bug(Lunn，Thomas，Best&Spiegelhalter，2000；A.Thomas，O‘Hara，Ligges&Sturtz，2006)和Stan(Stan Development Team，2012)软件的创建者。还要感谢排版软件LaTeX(http://www.latex-project.org/)和MIKT ex(http://miktex.org/)，编辑T eXaker(http://www.xm1math.net/texaker/)的创建者，以及作者撰写本书的LibreOffice.libreoffice.org/绘图应用程序(http://www.libreoffice.org/)

我向所有做出贡献但我无意中忘记提及的人致以歉意和诚挚的谢意。

最后，我最深切地感谢Rima Hanania博士，在写这本书的这些年里，他一直是我最尊敬的伴侣。